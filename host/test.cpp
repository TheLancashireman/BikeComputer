
#include <Arduino.h>
#include <BikeComputer.h>
#include <stdio.h>

const char *testdata[] =
{
	"$GPRMC,062516.00,V,,,,,,,300521,,,N*7E\n",
	"$GPRMC,062532.00,A,4939.17923,N,01101.76035,E,0.095,,300521,,,A*76\n",
	"$GPRMC,062533.00,V,,,,,,,300521,,,N*79\n",
	"$GPRMC,062534.00,A,4939.17749,N,01101.75921,E,0.387,,300521,,,A*7D\n",
	"$GPRMC,062535.00,A,4939.17723,N,01101.75900,E,0.583,,300521,,,A*71\n",
	"$GPRMC,062536.00,A,4939.17696,N,01101.75885,E,0.729,,300521,,,A*73\n",
	"$GPRMC,062537.00,A,4939.17679,N,01101.75882,E,0.234,,300521,,,A*7D\n",
	"$GPRMC,062538.00,A,4939.17653,N,01101.75882,E,0.161,,300521,,,A*79\n",
	"$GPRMC,062539.00,A,4939.17636,N,01101.75883,E,0.198,,300521,,,A*7C\n",
	"$GPRMC,062540.00,A,4939.17627,N,01101.75886,E,0.198,,300521,,,A*77\n",
	"$GPRMC,062541.00,A,4939.17620,N,01101.75881,E,0.509,,300521,,,A*7A\n",
	"$GPRMC,062542.00,A,4939.17601,N,01101.75888,E,0.319,,300521,,,A*74\n",
	"$GPRMC,062543.00,A,4939.17602,N,01101.75929,E,1.326,34.62,300521,,,A*5C\n",
	"$GPRMC,062544.00,A,4939.17655,N,01101.75949,E,0.838,,300521,,,A*77\n",
	"$GPRMC,062545.00,A,4939.17690,N,01101.76016,E,0.882,,300521,,,A*7E\n",
	"$GPRMC,062546.00,A,4939.17671,N,01101.75982,E,1.191,,300521,,,A*7F\n",
	"$GPRMC,062547.00,A,4939.17635,N,01101.75973,E,0.839,,300521,,,A*7A\n",
	"$GPRMC,062548.00,A,4939.17634,N,01101.75943,E,1.228,,300521,,,A*7C\n",
	"$GPRMC,062549.00,A,4939.17597,N,01101.75895,E,2.457,269.12,300521,,,A*60\n",
	"$GPRMC,062550.00,A,4939.17557,N,01101.75891,E,1.695,242.65,300521,,,A*66\n",
	"$GPRMC,062551.00,A,4939.17536,N,01101.75862,E,0.457,,300521,,,A*78\n",
	"$GPRMC,062552.00,A,4939.17507,N,01101.75853,E,0.250,,300521,,,A*7A\n",
	"$GPRMC,062553.00,A,4939.17538,N,01101.75883,E,1.485,,300521,,,A*75\n",
	"$GPRMC,062554.00,A,4939.17468,N,01101.75804,E,1.259,,300521,,,A*7E\n",
	"$GPRMC,062555.00,A,4939.17434,N,01101.75790,E,0.519,,300521,,,A*76\n",
	"$GPRMC,062556.00,A,4939.17382,N,01101.75745,E,0.731,,300521,,,A*7F\n",
	"$GPRMC,062557.00,A,4939.17371,N,01101.75704,E,0.038,,300521,,,A*79\n",
	"$GPRMC,062558.00,A,4939.17361,N,01101.75671,E,0.752,,300521,,,A*7F\n",
	"$GPRMC,062559.00,A,4939.17416,N,01101.75714,E,1.246,322.75,300521,,,A*65\n",
	"$GPRMC,062600.00,A,4939.17480,N,01101.75774,E,0.207,,300521,,,A*78\n",
	"$GPRMC,062601.00,A,4939.17530,N,01101.75821,E,0.253,,300521,,,A*7D\n",
	"$GPRMC,062602.00,A,4939.17579,N,01101.75841,E,1.269,346.11,300521,,,A*62\n",
	"$GPRMC,062603.00,A,4939.17607,N,01101.75825,E,1.178,,300521,,,A*77\n",
	"$GPRMC,062604.00,A,4939.17609,N,01101.75786,E,1.241,,300521,,,A*71\n",
	"$GPRMC,062605.00,A,4939.17582,N,01101.75714,E,1.924,,300521,,,A*73\n",
	"$GPRMC,062606.00,A,4939.17633,N,01101.75670,E,1.566,,300521,,,A*70\n",
	"$GPRMC,062607.00,A,4939.17641,N,01101.75622,E,1.362,,300521,,,A*71\n",
	"$GPRMC,062608.00,A,4939.17672,N,01101.75592,E,1.116,,300521,,,A*77\n",
	"$GPRMC,062609.00,A,4939.17681,N,01101.75563,E,0.996,,300521,,,A*75\n",
	"$GPRMC,062610.00,A,4939.17686,N,01101.75540,E,0.405,,300521,,,A*7C\n",
	"$GPRMC,062611.00,A,4939.17821,N,01101.75553,E,5.332,14.76,300521,,,A*50\n",
	"$GPRMC,062612.00,A,4939.17868,N,01101.75553,E,2.401,14.61,300521,,,A*58\n",
	"$GPRMC,062613.00,A,4939.17948,N,01101.75579,E,1.951,,300521,,,A*75\n",
	"$GPRMC,062614.00,A,4939.18067,N,01101.75613,E,0.952,,300521,,,A*74\n",
};

extern uint8_t gps_decode(const char *s);

int main(int argc, char **argv)
{
	int i,n,rec;
	printf("Hello, World\n");

	n = sizeof(testdata) / sizeof(char*);
	printf("%d test strings\n", n);

	for ( i = 0; i < n; i++)
	{
		printf(testdata[i]);
		for ( modes = MODE_POSN; modes < MODE_NMODE; modes++ )
		{
			printf("Mode %d\n", modes);
			rec = gps_decode(testdata[i]);
			printf("\ngps_decode() returned %d\n", rec);
		}
	}
	
	return 0;
}
